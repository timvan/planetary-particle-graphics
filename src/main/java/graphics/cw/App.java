/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package graphics.cw;

import graphics.cw.display.Display;
import graphics.cw.display.Info;
import graphics.cw.particles.*;
import processing.core.PApplet;

import java.awt.*;

public class App extends PApplet {

    int width = Constants.windowWidth;
    int height = Constants.windowHeight;

    Grid grid;
    Display display;
    ParticleSystem ps;
    ParticleMouseHandler particleMouseHandler;
    Info info;

    public void settings() {
        size(width, height, "processing.awt.PGraphicsJava2D");
    }

    public void setup() {
        grid = new Grid(width, height);
        display = new Display(this);
        ps = new ParticleSystem(grid);
        particleMouseHandler = new ParticleMouseHandler(ps);
        info = new Info(display, 100, 100);
        this.smooth();
        background(Color.BLACK.getRGB());
        ps.setup();
    }

    public void draw() {
        fill(Color.BLACK.getRGB(), (float) 50);
        translate(0, 0);
        rectMode(1);
        rect(0, 0, width, height);
        ps.update();

        for(Particle particle : ps.getParticles()){
            display.drawCircle(particle.getLocation(), particle.getRadius(), Color.WHITE);
        }

        for(Feature feature : ps.getFeatures()){
            if(feature.getMass() < 0){
                display.drawCircle(feature.getLocation(), feature.getRadius(), Color.YELLOW);
            } else {
                display.drawCircle(feature.getLocation(), feature.getRadius(), Color.RED);
            }

        }

        for(Spawner spawner : ps.getSpawners()){
            display.drawCircle(spawner.getLocation(), spawner.getRadius(), Color.BLUE);
        }

        Goal goal = ps.getGoal();
        display.drawCircle(goal.getLocation(), goal.getRadius(), Color.MAGENTA);

        info.update(mouseX, mouseY);
        info.display();

    }

    public void mousePressed() {
        particleMouseHandler.mousePressed(mouseX, mouseY);
    }

    public void mouseReleased() {
        particleMouseHandler.mouseReleased(mouseX, mouseY);
    }

    public void mouseDragged() {
        particleMouseHandler.mouseDragged(mouseX, mouseY);
    }

    public void keyPressed() {
        particleMouseHandler.keyPressed(key, mouseX, mouseY);
    }

    public static void main(String[] passedArgs) {
        String[] appletArgs = new String[] {
                "graphics.cw.App"
        };
        PApplet.main(appletArgs);
    }

}